@if (personStore.isReady()) {
  <form [formGroup]="personForm">
    <div class="edit-button-container">
      <button
        mat-flat-button
        type="button"
        (click)="personStore.toggleEditMode()"
        class="default-button"
        [disabled]="personStore.inEditMode()"
      >
        Edit
      </button>
    </div>

    @if (personStore.isErrored()) {
      <aw-error-container [errors]="personStore.errors()" />
    }
    <mat-form-field>
      <mat-label>Family Name</mat-label>
      <input matInput placeholder="Name" formControlName="familyName" />
      @if (personForm.controls.familyName.hasError('required')) {
        <mat-error>
          Family Name is
          <strong>required</strong>
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field>
      <mat-label>Given Name</mat-label>
      <input matInput placeholder="Name" formControlName="givenName" />
      @if (personForm.controls.givenName.hasError('required')) {
        <mat-error>
          Given Name is
          <strong>required</strong>
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field>
      <mat-label>Person Type</mat-label>
      <mat-select
        formControlName="personType"
        [compareWith]="comparePersonTypes"
      >
        @for (personType of personStore.personTypes(); track personType.id) {
          <mat-option [value]="personType">
            {{ personType.name }}
          </mat-option>
        }
      </mat-select>
      @if (personForm.controls.personType.hasError('required')) {
        <mat-error>
          Person Type is
          <strong>required</strong>
        </mat-error>
      }
    </mat-form-field>

    <div class="form-button-container">
      <button
        mat-button
        type="button"
        (click)="personStore.toggleEditMode()"
        class="default-button"
        [disabled]="!personStore.inEditMode()"
      >
        Cancel
      </button>
      <button
        mat-flat-button
        type="submit"
        class="default-button"
        [disabled]="
          !personStore.inEditMode() || !personForm.valid || !personForm.dirty
        "
      >
        Save
      </button>
    </div>
  </form>
}
